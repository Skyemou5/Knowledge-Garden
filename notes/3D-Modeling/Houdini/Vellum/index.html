<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Vellum is a unified solver for softbody dynamics (hair, wire, cloth)
Vellum is similar to Houdini &ldquo;grains&rdquo; -PBD (Position based dynamics) - Vellum is a continuation of grains."><title>Vellum Houdini</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://notes.benshurts.com//icon.png><link href=https://notes.benshurts.com/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://notes.benshurts.com/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://notes.benshurts.com/js/darkmode.7f1fd235efdec6a4bdcb4d8d99113082.min.js></script>
<script src=https://notes.benshurts.com/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://notes.benshurts.com/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://notes.benshurts.com/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://notes.benshurts.com/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://notes.benshurts.com/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://notes.benshurts.com/",fetchData=Promise.all([fetch("https://notes.benshurts.com/indices/linkIndex.df656983fbbff1f9c4823da916428e18.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://notes.benshurts.com/indices/contentIndex.b64aa8ba9a87d31828dce5a30d1d9e22.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://notes.benshurts.com",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://notes.benshurts.com",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/notes.benshurts.com\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://notes.benshurts.com/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://notes.benshurts.com/>Knowledge Garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Vellum Houdini</h1><p class=meta>Last updated
Jan 31, 2023
<a href=https://github.com/benshurts/Knowledge-Garden/notes/3D-Modeling/Houdini/Vellum.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://notes.benshurts.com/tags/vellum/>Vellum</a></li><li><a href=https://notes.benshurts.com/tags/houdini/>Houdini</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#pinning-vellum>Pinning Vellum</a><ol><li><a href=#bend-stiffness>Bend Stiffness</a></li></ol></li><li><a href=#3-different-soft-body-types>3 Different Soft-body types</a><ol><li><a href=#balloons>Balloons</a></li></ol></li><li><a href=#vellum-strings>Vellum Strings</a><ol><li><a href=#pinning>Pinning</a></li></ol></li></ol><ol><li><ol><li><a href=#dopnet-method>DOPnet method</a></li><li><a href=#vellum-post-process>Vellum Post-Process</a></li></ol></li></ol></nav></details></aside><p>Vellum is a unified solver for softbody dynamics (hair, wire, cloth)</p><p>Vellum is similar to Houdini &ldquo;grains&rdquo; -PBD (Position based dynamics) - Vellum is a continuation of grains.</p><blockquote><p>Constraints are similar to <em>Bullet</em> constraints and <em>Internal</em> constraints.</p><p>Stretching, damping, bendability, etc</p></blockquote><blockquote><p>Vellum is a successor to <em>POPs</em> in many ways</p></blockquote><blockquote class=important-callout><p>It&rsquo;s always recommended to use <em>Vellum</em> with a triangulated mesh.</p></blockquote><hr><a href=#simple-vellum-setup><h1 id=simple-vellum-setup><span class=hanchor arialabel=Anchor># </span>Simple Vellum Setup</h1></a><p>Vellum has many different <em>constraint</em> types. These all use slightly different mathematics across the graph structure.</p><p><img src="/notes/attachments/Pasted image 20221209170241.png" width=auto></p><div class=mermaid>graph TD
Mesh --> VellumConstraints
VellumConstraints --> VellumSolver</div><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0})</script><blockquote class=note-callout><p>Vellum sims <em>often</em> require many substeps. around 5</p><p>Adding substeps will add multiple calculations per frame which can stiffen the simulation because it&rsquo;s going to calculate the stiffness more times.</p><p>To account for this you may need to play around with reducing stiffness</p></blockquote><blockquote class=important-callout><p>If vellum is behaving strangely, one of the first things you should do is visualize the <em>thickness</em> of the simulation</p><p><img src="/notes/attachments/Pasted image 20230113145220.png" width=auto></p><p>The green spheres represent the thickness that the vellum solver is using to calculate things.</p></blockquote><p><img src="/notes/attachments/Pasted image 20221214091838.png" width=auto></p><blockquote class=important-callout><p>Cloth Thickness</p><p>You don&rsquo;t want your cloth to be too thick <em>or</em> too thin. It will create strange velocities and artifacts.</p><p>Too thick -> If the spheres start to overlap then it will push the verts away from eachother. Might also add strange velocity.</p><p>Too thin -> strange behavior, gravity or collisions may break.</p></blockquote><p>Settings you will use <em>all</em> the time in vellum are:</p><ol><li><em>Stretch</em> Stiffness</li><li><em>Bend</em> Stiffness</li></ol><p><img src="/notes/attachments/Pasted image 20230113145806.png" width=auto></p><p>Stretch Stiffness => How hard it is to stretch the constraints apart. Low -> High</p><a href=#pinning-vellum><h2 id=pinning-vellum><span class=hanchor arialabel=Anchor># </span>Pinning Vellum</h2></a><p>In the <em>vellum constraints node</em> there is a <em>Pin to Animation</em> section. If you click the cursor you can use the viewport to select the points you want to pin.</p><p><img src="/notes/attachments/Pasted image 20230113151008.png" width=auto></p><blockquote class=note-callout><p>Finding the right values</p><p>For simulations it can be difficult to find the right values like <em>Bend Stiffness</em> for example. The recommended workflow is change by factors of 10 until you are in the right ballpark, then use the smaller increments with the slider.</p><p><img src="/notes/attachments/Pasted image 20230113151919.png" width=auto></p></blockquote><a href=#bend-stiffness><h3 id=bend-stiffness><span class=hanchor arialabel=Anchor># </span>Bend Stiffness</h3></a><p>This is somewhat self-explanatory. However you can think of it as different materials. For example a cloth with high bend-stiffness might be rubber, it&rsquo;s hard to fold, even thin pieces. A cloth with low bend-stiffness could be silk.</p><p>A nice way to see the effects of <em>bend-stiffness</em> the following setup:</p><p><img src="/notes/attachments/Pasted image 20230113155546.png" width=auto></p><p>Then we can add some forces. There are two ways to do this.</p><ol><li>Inside the vellum-solver</li><li>before the vellum-solver</li></ol><p><img src="/notes/attachments/Pasted image 20230113155625.png" width=auto></p><blockquote class=important-callout><p>Preparing Meshes</p><p>When doing simulations it&rsquo;s good practice to prepare the mesh. For example if you want to sim the <em>rubber toy</em> in houdini you probably want to fuse all the pieces together with a boolean, or vdb, and then remesh it.</p><p><img src="/notes/attachments/Pasted image 20230113161503.png" width=auto></p><p>Another thing to keep in mind: You may not want your final geo to be the remeshed geo. Often so you can have your UVs back or something like that.</p><p>One solution to that is <em>Point deforming</em> the original mesh with the simulated mesh.</p><p><img src="/notes/attachments/Pasted image 20230113161846.png" width=auto></p></blockquote><a href=#3-different-soft-body-types><h2 id=3-different-soft-body-types><span class=hanchor arialabel=Anchor># </span>3 Different Soft-body types</h2></a><ul><li>Balloon -> Always tried to hold the same amount of volume inside (preserves volume globaly)<ul><li><img src=/notes/attachments/baloon1.gif width=auto></li></ul></li><li>Struts -> Creates internal constraint geo to act as structural supports. Makes it resist compression.<ul><li><img src="/notes/attachments/Pasted image 20230113162444.png" width=auto></li></ul></li><li>Tet -> considered <em>regionally</em> volume preserving. It creates a lattice of triangles on the inside, to calculate what the volume is through the whole shape. Good for objects that are stiffer than balloons. For this you need to remesh and have regularly spaced triangles.</li></ul><blockquote><p>Struts are fast, but there are sometimes artifacts that have to be fixes. Usually due to the struts in the center that are straight up-and-down</p></blockquote><a href=#balloons><h3 id=balloons><span class=hanchor arialabel=Anchor># </span>Balloons</h3></a><p>Balloons are made up of cloth around the outside, and a pressure constraint system that runs along the surface and the inside that pushes out from the inside.</p><p>If you make your pressure constraint really stiff it will push outward.</p><p>If the cloth is loose the object will keep inflating and become rounder and rounder.</p><blockquote class=important-callout><p>Your geo might be fine, but check for creasing or verts too close together if you have artifacts.</p></blockquote><a href=#vellum-strings><h2 id=vellum-strings><span class=hanchor arialabel=Anchor># </span>Vellum Strings</h2></a><p>If you want to make a string you want to start from a line. Add more length and points.</p><div class=mermaid>graph TD
Line --> VellumConstraints-hair
VellumConstraints-hair --> VellumSolver</div><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0})</script><blockquote class=note-callout><p>Hair and String are basically the same except that Hair <em>can</em> twist and string <strong>CANNOT</strong></p></blockquote><p>An important value in many sims but especially vellum is <em>Restlength</em>.</p><p><strong>Restlength</strong> is the value that holds the original spacing between constraints.</p><p>One value we can play with is <em>Restlength Scale</em>.</p><p><img src="/notes/attachments/Pasted image 20230113170519.png" width=auto></p><p>This allows us to make adjustments to the original <em>restlength</em>.</p><p>If we set it to 2, for example, it will take the originally generated <em>restlength</em> and multiply it by 2.</p><p>If you want to animate this property you have to do a few things.</p><blockquote class=important-callout><p>Like most other solvers, attributes set before the solver are only set at the very beginning of the sim by default.</p></blockquote><p>If you want to change constraint properties <em>during</em> a simulation, you can use a <em>vellum constrain properties</em> node inside the solver.</p><p><img src="/notes/attachments/Pasted image 20230113171104.png" width=auto></p><p>You can now add keyframes on the properties inside this node.</p><a href=#pinning><h3 id=pinning><span class=hanchor arialabel=Anchor># </span>Pinning</h3></a><p>Pinning is a way we can attach cloth to objects.</p><p><img src="/notes/attachments/Pasted image 20230120181830.png" width=auto></p><p><img src="/notes/attachments/Pasted image 20230120181903.png" width=auto></p><p>In vellum constraints all you need to do is set the pin group and check <em>match animation</em>.</p><a href=#final-sim><h1 id=final-sim><span class=hanchor arialabel=Anchor># </span>Final Sim</h1></a><p>Like with <strong>RBD</strong> we can <em>Vellum Pack</em></p><p><img src="/notes/attachments/Pasted image 20230120182716.png" width=auto></p><p>Another Approach is to setup different vellum <em>sources</em>.</p><p><img src="/notes/attachments/Pasted image 20230120183818.png" width=auto></p><p>In this case you set up different nulls for outputs of each simulation.</p><p>Then in another <em>vellumsolver</em> add 3 <em>vellum source</em> nodes and set up the <em>geo</em> and <em>constraint</em> fields to the nulls.</p><p><img src="/notes/attachments/Pasted image 20230120184057.png" width=auto></p><p><img src="/notes/attachments/Pasted image 20230120184108.png" width=auto></p><p>The nice thing about this method is that you can create groups for</p><a href=#dopnet-method><h3 id=dopnet-method><span class=hanchor arialabel=Anchor># </span>DOPnet method</h3></a><p>Start out with a simple vellum setup inside the dop.</p><p><img src="/notes/attachments/Pasted image 20230120190455.png" width=auto></p><p>Next you will want to source all the vellum objects like before.</p><p><img src="/notes/attachments/Pasted image 20230120190745.png" width=auto></p><p>Plug them into input 3 of the vellum solver.</p><p><img src="/notes/attachments/Pasted image 20230120191732.png" width=auto></p><p><img src="/notes/attachments/Pasted image 20230120191859.png" width=auto>
In DOPs the <em>objects</em> hold the simulation data.</p><a href=#vellum-post-process><h3 id=vellum-post-process><span class=hanchor arialabel=Anchor># </span>Vellum Post-Process</h3></a></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/notes/3D-Modeling/Houdini/Houdini-Hub/ data-ctx=notes/3D-Modeling/Houdini/Vellum data-src=/notes/3D-Modeling/Houdini/Houdini-Hub class=internal-link>Houdini Hub</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://notes.benshurts.com/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Ben Shurts using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://notes.benshurts.com/>Home</a></li><li><a href=https://twitter.com/artofbenshurts>Twitter</a></li><li><a href=https://github.com/benshurts>Github</a></li></ul></footer></div></div></body></html>