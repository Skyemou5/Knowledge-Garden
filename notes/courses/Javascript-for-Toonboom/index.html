<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="In toonboom the extension language is Javascript. We can use their extensive API to automate and extend our workflows to make us more effectient as artists and help teams and studios work more efficently."><title>Javascript for Toonboom</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://notes.benshurts.com//icon.png><link href=https://notes.benshurts.com/styles.708c2658f93e3a9d323a1f9fded8f4b2.min.css rel=stylesheet><link href=https://notes.benshurts.com/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://notes.benshurts.com/js/darkmode.7f1fd235efdec6a4bdcb4d8d99113082.min.js></script>
<script src=https://notes.benshurts.com/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://notes.benshurts.com/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://notes.benshurts.com/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://notes.benshurts.com/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://notes.benshurts.com/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://notes.benshurts.com/",fetchData=Promise.all([fetch("https://notes.benshurts.com/indices/linkIndex.df656983fbbff1f9c4823da916428e18.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://notes.benshurts.com/indices/contentIndex.5444e9dd2c393f4c89818a47f55737ef.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://notes.benshurts.com",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://notes.benshurts.com",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/notes.benshurts.com\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://notes.benshurts.com/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://notes.benshurts.com/>Knowledge Garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Javascript for Toonboom</h1><p class=meta>Last updated
Feb 13, 2023
<a href=https://github.com/benshurts/Knowledge-Garden/notes/courses/Javascript%20for%20Toonboom.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://notes.benshurts.com/tags/javascript/>Javascript</a></li><li><a href=https://notes.benshurts.com/tags/toonboom/>Toonboom</a></li><li><a href=https://notes.benshurts.com/tags/class/>Class</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><ol><li><a href=#qtscript>QTScript</a></li></ol></li></ol><ol><li><a href=#getting-started>Getting Started</a><ol><li><a href=#below-are-the-storage-locations>Below are the storage locations:</a></li><li><a href=#the-script-editor-ui>The Script Editor UI</a></li></ol></li><li><a href=#debugging-qt-scripts>Debugging QT Scripts</a></li><li><a href=#importing-scripts>Importing Scripts</a></li><li><a href=#external-script-editors>External Script Editors</a></li></ol><ol><li><a href=#documentation>Documentation</a></li><li><a href=#getting-started-simple-script>Getting Started: Simple Script</a><ol><li><a href=#sample-scripts>Sample Scripts</a></li><li><a href=#writing-your-first-script>Writing Your First Script</a></li></ol></li></ol></nav></details></aside><p>In toonboom the extension language is <em>Javascript</em>. We can use their extensive <em>API</em> to automate and extend our workflows to make us more effectient as artists and help teams and studios work more efficently.</p><p>Before we jump in we should understand some basic things about how ToonBoom is built. The most important is the framework we will be interacting with.</p><a href=#qt><h1 id=qt><span class=hanchor arialabel=Anchor># </span>QT</h1></a><p>A large part of ToonBoom is built using a framework called QT.</p><p>Qt is a cross-platform software development framework and application development toolkit used for creating applications that run on multiple platforms, including Windows, macOS, Linux, Android, and iOS. It was originally developed by the Norwegian company Trolltech, which was later acquired by Nokia, and is now developed and maintained by the Qt Company.</p><p>Qt provides a set of APIs for developing graphical user interfaces (GUIs), as well as a range of other functionality, including networking, databases, multimedia, and more. It also includes a powerful development environment, the Qt Creator, that provides a visual editor for designing user interfaces and a code editor for writing and debugging code.</p><p>In addition to C++, Qt supports scripting languages, including Python, JavaScript (through QtScript), and Ruby, which makes it accessible to a wider range of developers with different backgrounds and skill sets. Qt is widely used in a variety of industries, including automotive, finance, healthcare, and media and entertainment.</p><a href=#toonboom-and-qt><h1 id=toonboom-and-qt><span class=hanchor arialabel=Anchor># </span>Toonboom and QT</h1></a><p><a href=https://docs.toonboom.com/help/harmony-22/premium/scripting/about-scripting.html rel=noopener>Harmony 22 Premium Documentation: About Scripting</a></p><p>Toonboom infact uses
<a href=https://doc.qt.io/qt-5/qtscript-index.html rel=noopener>Qt Script</a> which is similar to <em>javascript</em>. In fact it&rsquo;s based on JavaScript. Which is why we are focusing on learning Javascript first.</p><a href=#qtscript><h3 id=qtscript><span class=hanchor arialabel=Anchor># </span>QTScript</h3></a><p>QtScript is a scripting language based on JavaScript and specifically designed for the Qt framework. It provides a set of APIs for accessing the application&rsquo;s user interface and objects, and enables the creation of macros and scripts for automating repetitive tasks in Qt applications.</p><p>QtScript is easy to learn and use, especially for developers with a background in JavaScript, and provides a more streamlined interface for accessing the application&rsquo;s functionality compared to using the Qt C++ API. QtScript scripts are typically used for simple tasks and can be easily integrated into larger projects, which makes them a convenient tool for rapid prototyping and testing.</p><p>QtScript has a number of features and capabilities that make it well-suited for use in Qt applications, including support for multithreading, garbage collection, and the ability to handle and respond to events. It also provides access to the full range of Qt APIs, which enables the creation of powerful and flexible scripts and macros.</p><hr><a href=#first-steps-for-scripting-in-toonboom><h1 id=first-steps-for-scripting-in-toonboom><span class=hanchor arialabel=Anchor># </span>First Steps for Scripting in ToonBoom</h1></a><p><a href=https://learn.toonboom.com/courses/harmony-scripting rel=noopener>Harmony Scripting | Toon Boom Learn</a></p><blockquote><p>To clear up some confusion about javascript vs qtscript in toonboom. Qt Scripts still use the .js file extension and are basically javascript. The only notable difference is the way we use javascript/qtscript in this case. We use it through the ToonBoom QT api instead of it targeting webassembly for the browsers.</p></blockquote><a href=#getting-started><h2 id=getting-started><span class=hanchor arialabel=Anchor># </span>Getting Started</h2></a><p>Navigate to the <em>Scripting</em> workspace:</p><p><img src="/Pasted image 20230210123223.png" width=auto></p><p>The scripting window shows a list of scripts you can use.</p><p>The <em>Sandbox</em> script is a special script that is discarded after use. Good for testing things out.</p><p><img src="/Pasted image 20230210123333.png" width=auto></p><p>To create a new script use the hamburger menu at the top left of the scripting window and select: File -> new script:</p><p><img src="/Pasted image 20230210123430.png" width=auto></p><p>Then enter the name of your script. After that select where you wish it to be stored.</p><a href=#below-are-the-storage-locations><h3 id=below-are-the-storage-locations><span class=hanchor arialabel=Anchor># </span>Below are the storage locations:</h3></a><ul><li>Windows:<ul><li>Toon Boom Harmony <strong>Premium</strong>: <code>C:\Users\[user_name]\AppData\Roaming\Toon Boom Animation\Toon Boom Harmony\1400-scripts</code></li><li>Toon Boom Harmony <strong>Advanced</strong>: <code>C:\Users\[user_name]\AppData\Roaming\Toon Boom Animation\Toon Boom Advanced\1400-scripts</code></li><li>Toon Boom Harmony <strong>Essentials</strong>: <code>C:\Users[\user_name]\AppData\Roaming\Toon Boom Animation\Toon Boom Essentials\1400-scripts</code></li></ul></li><li>macOS:<ul><li>Toon Boom Harmony <strong>Premium</strong>: <code>/Users/[user_name]/Library/Preferences/Toon Boom Animation/Toon Boom Harmony/1400-scripts</code></li><li>Toon Boom Harmony <strong>Advanced</strong>: <code>/Users/[user_name]/Library/Preferences/Toon Boom Animation/Toon Boom Advanced/1400-scripts</code></li><li>Toon Boom Harmony <strong>Essentials</strong>: <code>/Users/[user_name]/Library/Preferences/Toon Boom Animation/Toon Boom Essentials/1400-scripts</code></li></ul></li></ul><p>On macOS, the Library folder is a hidden folder. To display the display the folder, told down the Alt key.</p><ul><li>Linux:<ul><li><code>/home/[user_name]/Toon Boom Animation/Toon Boom Harmony/1400-scripts/</code></li><li><code>/home/[user_name]/Toon Boom Animation/Toon Boom StageAdvanced/1400-scripts/</code></li></ul></li></ul><p>When working with Harmony Server, your custom scripts are stored in:</p><ul><li><strong>Global</strong>: <code>[Server_Name] > USA_DB > scripts</code></li><li><strong>Environment</strong>: <code>[Server_Name] > USA_DB > environments > [environment_name]</code></li><li><strong>Job</strong>: <code>[Server_Name] > USA_DB > jobs > [job name]</code></li><li><strong>User</strong>: <code>[Server_Name] > USA_DB > users > [user_name] > stage > 1400-scripts</code></li></ul><p>You may want to utilize git to save your tools.</p><blockquote class=note-callout><p>For this course I do expect your toonboom scripts to be turned in with a github url.</p></blockquote><a href=#the-script-editor-ui><h3 id=the-script-editor-ui><span class=hanchor arialabel=Anchor># </span>The Script Editor UI</h3></a><p>Once you write something in the editor, you can quickly check your syntax with the <em>verify</em> button:</p><p><img src="/Pasted image 20230210124324.png" width=auto></p><p>To run a script, do the one of the following:</p><ul><li>From the <em>script editor toolbar</em> click the run script button:</li></ul><p><img src="/Pasted image 20230210124432.png" width=auto></p><ul><li>From the <em>script editor menu</em>, select <strong>Play/Debug > Run</strong></li></ul><blockquote class=note-callout><p>To avoid selecting the function every time you want to run your script, you can set a target function. In the Script Editor toolbar, click the Set Target!<img src="/Pasted image 20230210124853.png" width=auto> button or select <strong>Play/Debug > Set Target</strong> from the Script Editor menu. In the Function column, select the function to target and press <strong>OK</strong>.</p></blockquote><p>Now your script will appear in the menu:</p><p><img src="/Pasted image 20230210125319.png" width=auto></p><p>To stop the execution of a script click the <img src="/Pasted image 20230210125538.png" width=auto> stop script button.</p><a href=#debugging-qt-scripts><h2 id=debugging-qt-scripts><span class=hanchor arialabel=Anchor># </span>Debugging QT Scripts</h2></a><p>To run the debugger in toonboom click the <img src="/Pasted image 20230210125900.png" width=auto> <em>debugger</em> button in the toolbar.</p><p>This will bring up the the <em>debugger</em>:</p><p><img src="/Pasted image 20230210125940.png" width=auto></p><p>The debugger will allow us to set <em>breakpoints</em> and <em>step through</em> our code to find problems easier.</p><a href=#importing-scripts><h2 id=importing-scripts><span class=hanchor arialabel=Anchor># </span>Importing Scripts</h2></a><p>To use scripts prepared by other users, transfer the *.js files from the computer where the scripts were created to the one that you intend to use. Then use the Script Editor to import the *.js files from where they are saved on your computer.</p><p>When working with Harmony Stand Alone, scripts that you created while working on a scene or imported are available for all other projects created on the same computer; there&rsquo;s no need for any kind of transfer or import. You can find your custom, default and imported scripts in:</p><p>Refer back to the script locations: <a class="internal-link broken">Script Paths</a></p><a href=#external-script-editors><h2 id=external-script-editors><span class=hanchor arialabel=Anchor># </span>External Script Editors</h2></a><p>You can set and open an external script editor with the respective buttons on the toolbar:</p><p><img src="/Pasted image 20230210130633.png" width=auto></p><blockquote class=note-callout><p>To set the external script editor copy the path into the field to the exectable or navigate to it.</p></blockquote><a href=#creating-a-simple-script><h1 id=creating-a-simple-script><span class=hanchor arialabel=Anchor># </span>Creating A Simple Script</h1></a><p>You will create a script with either the built-in script editor or your external editor of choice.</p><a href=#documentation><h2 id=documentation><span class=hanchor arialabel=Anchor># </span>Documentation</h2></a><p>It&rsquo;s important to read and reference the documentation for any sort of complex project. The relivant documentation is linked below:</p><ul><li><a href=https://docs.toonboom.com/help/harmony-20/scripting/script/index.html rel=noopener>Harmony 20 Scripting Interface</a></li><li><a href=https://docs.toonboom.com/help/harmony-20/scripting/scriptmodule/index.html rel=noopener>Harmony 20 Script Node</a></li><li><a href=https://docs.toonboom.com/help/harmony-20/scripting/dbscript/index.html rel=noopener>Harmony 20 Control Center Scripting</a></li></ul><a href=#getting-started-simple-script><h2 id=getting-started-simple-script><span class=hanchor arialabel=Anchor># </span>Getting Started: Simple Script</h2></a><blockquote class=note-callout><p>To find most parameters to use in your script, you can refer to a Harmony project <code>*.xstage</code> file. When opening the file in a text or script editor, you can see all layers, nodes, values, and parameters used in the project. When looking for a specific value, you can add a layer or node in your project, set the parameter in the UI and save the project. Following the save operation, you can then open the <code>*.xstage</code> file in your text editor and look at all the provided values.</p></blockquote><a href=#sample-scripts><h3 id=sample-scripts><span class=hanchor arialabel=Anchor># </span>Sample Scripts</h3></a><p>Before we get started, below are some of reference material. You should save the code to a <code>.js</code> file with the specified name.</p><p><code>Create_Drawing_Nodes.js</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  	<span class=c1>//Gets the selected nodes.
</span></span></span><span class=line><span class=cl><span class=c1></span>    	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//Process if only one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Compiles all operations to undo in one action.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>scene</span><span class=p>.</span><span class=nx>beginUndoRedoAccum</span><span class=p>(</span><span class=s2>&#34;Create Drawing Nodes&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>		<span class=c1>//Loops through the selected nodes.
</span></span></span><span class=line><span class=cl><span class=c1></span>   		 <span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>			<span class=c1>//Gets the instance of the currently selected node.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=c1>//Gets the X and Y coordinate of the selected node.
</span></span></span><span class=line><span class=cl><span class=c1></span> 			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>         		<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>//Loops 4 times.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=c1>//Adds a new drawing node close to the selected composite node.
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>-</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=c1>//Links the new node to the selected Composite.
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=nx>node</span><span class=p>.</span><span class=nx>link</span><span class=p>(</span><span class=nx>newNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>currentNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Ends the undo redo stack.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>scene</span><span class=p>.</span><span class=nx>endUndoRedoAccum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Displays a warning message if 0 or more than one node is selected.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only 1 Composite node.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>Create_Drawing_Nodes-Composite-Validation.js</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  	<span class=c1>//Gets the selected nodes.
</span></span></span><span class=line><span class=cl><span class=c1></span>    	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//Process if only one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Compiles all operations to undo in one action.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>scene</span><span class=p>.</span><span class=nx>beginUndoRedoAccum</span><span class=p>(</span><span class=s2>&#34;Create Drawing Nodes&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>		<span class=c1>//Loops through the selected nodes.
</span></span></span><span class=line><span class=cl><span class=c1></span>   		 <span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>			<span class=c1>//Gets the instance of the currently selected node.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>//Gets the selected node type.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>nodeType</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>type</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=c1>//Checks if the node is a Composite.
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span><span class=p>(</span><span class=nx>nodeType</span> <span class=o>==</span> <span class=s2>&#34;COMPOSITE&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=c1>//Gets the X and Y coordinate of the selected node.
</span></span></span><span class=line><span class=cl><span class=c1></span> 				<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>         			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=c1>//Loops 4 times.
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>					<span class=c1>//Adds a new drawing node close to the selected composite node.
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>-</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=c1>//Links the new node to the selected Composite.
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>node</span><span class=p>.</span><span class=nx>link</span><span class=p>(</span><span class=nx>newNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>currentNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=p>}</span><span class=c1>//END OF FOR
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>			<span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=c1>//Displays a warning message if selected node is not a composite.
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select a Composite type node.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=p>}</span><span class=c1>//END OF IF
</span></span></span><span class=line><span class=cl><span class=c1></span> 
</span></span><span class=line><span class=cl>    		<span class=p>}</span><span class=c1>//END OF FOR
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Ends the undo redo stack.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>scene</span><span class=p>.</span><span class=nx>endUndoRedoAccum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>//Displays a warning message if 0 or more than one node is selected.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only 1 Composite node.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span><span class=c1>//END OF IF
</span></span></span><span class=line><span class=cl><span class=c1></span>	
</span></span><span class=line><span class=cl><span class=p>}</span><span class=c1>//END OF FUNCTION
</span></span></span></code></pre></td></tr></table></div></div><a href=#writing-your-first-script><h3 id=writing-your-first-script><span class=hanchor arialabel=Anchor># </span>Writing Your First Script</h3></a><p>To get started do the following:</p><ul><li>Open a blank project</li><li>Open the scripting workspace</li><li>Create a new script (as described above)</li><li>Name the new script <code>Create_Drawing_Nodes</code></li><li>Select the new script</li></ul><p>Now we are ready to go.</p><p>Let&rsquo;s create the first function.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// code will go here
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote class=important-callout><p>This script will work based on a selection.</p></blockquote><p>We will use the <code>selection</code> class to grab information about the selection.</p><p><a href=https://docs.toonboom.com/help/harmony-20/scripting/script/classselection.html rel=noopener>Harmony 20 Scripting Interface: selection Class Reference</a></p><p>We will use two functions from this class:</p><ul><li><code>numberOfNodesSelected</code> ()</li><li><code>selectedNode</code> (int i)</li></ul><p>Let&rsquo;s implement these concepts like so:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s make sure we only have one node selected. To do this we will check if <code>selectedNodes</code> is equal to <code>1</code> else we will return a warning with the <code>MessageBox</code> class.</p><blockquote class=note-callout><p>Later you can decide to validate that the selected node is a <em>Composite</em> Type</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote class=warning-callout><p>Make sure you save your script!</p></blockquote><p>Now that we have access to the currently selected node we can affect it using the
<a href=https://docs.toonboom.com/help/harmony-20/scripting/script/classnode.html rel=noopener>node Class</a>. We will use the <code>coordX()</code> and <code>coordY()</code> functions from the <code>node</code> class to get the X and Y positions of the node in the <em>Node View</em>.</p><p>well add the following code inside the <em>for loop</em>:</p><p><code>var posX = node.coordX(currentNode)</code>;</p><p>and this line:</p><p><code>var posY = node.coordY(currentNode);</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now that we have the information of the selected node, we can create new <em>drawing nodes</em> and link them to your selected <em>Composite</em>.</p><p>One of the best way to add new nodes in using a loop. We will create a loop after the we get the coordinate information.</p><p>Add the following code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=c1>// this loop iterates 5 times
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The code in context:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=c1>// this loop iterates 5 times
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>To <strong>ADD</strong> new nodes we will use the <code>add()</code> function from the <code>node</code> class.</p><p>add (String parentGroup, String name, String type, int x, int y, int z)`</p><p>Arguments explained:</p><ol><li>The first argument is which group to the add the node to. For this we will need the get the group info in which your selected Composite is.</li><li>The second argument is the name of the new node.</li><li>The third argument is the type of node to add. (in our example well be add a drawing node <code>*.xstage</code>)</li><li>The last arguments are for coordinates of where the node should be. (we will change the values based on the selected compites information)</li></ol><p>Below is the new line to add:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>The line in context:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we will add the group information.</p><p>One way to do this is by using the <code>parentNode()</code> function.</p><p>Edit the line we just added like so:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>To get the last argument about the node type we need to open the project <code>*.xstage</code> file. (yes this is anoying and silly)</p><p>In this file we can find lots of information about modules and general information about your scene.</p><p><img src="/Pasted image 20230212184809.png" width=auto></p><blockquote class=important-callout><p>Since the backend info doesn&rsquo;t always match the user interface string, it&rsquo;s important to verify it. <em>(Yes this is an oversight and shoul be fixed by toonboom&mldr; but whatever)</em></p></blockquote><p>Edit the line like so:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Add <code>"READ"</code> in the argument for type.</p><blockquote class=warning-callout><p>Save your script!</p></blockquote><p>Below should be your script so far:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we need to link the newly created nodes.</p><p>To do this we will use the <code>link()</code> function:</p><p><code>link (String srcNode, int srcPort, String dstNode, int dstPort)</code></p><p>This function takes a source node, the port number to connect from, the destination node, and which port number to connect it to.</p><p>We will add the following code below the <code>newNode</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>node</span><span class=p>.</span><span class=nx>link</span><span class=p>(</span><span class=nx>newNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>currentNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>And in context:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=nx>node</span><span class=p>.</span><span class=nx>link</span><span class=p>(</span><span class=nx>newNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>currentNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we have a functional script.</p><p>Because toonboom is wierd we have to fix it&rsquo;s undo system. So we should lump the entire script into a single undo step so don&rsquo;t have to undo everything we did in the script. We will add the following two lines:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>scene</span><span class=p>.</span><span class=nx>beginUndoRedoAccum</span><span class=p>(</span><span class=s2>&#34;Create Drawing Nodes&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>scene</span><span class=p>.</span><span class=nx>endUndoRedoAccum</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>And in context:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>createDrawingNodes</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>selectedNodes</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>numberOfNodesSelected</span><span class=p>();</span> <span class=c1>// create variable to store number of nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>selectedNodes</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// check if one node is selected
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>scene</span><span class=p>.</span><span class=nx>beginUndoRedoAccum</span><span class=p>(</span><span class=s2>&#34;Create Drawing Nodes&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>selectedNodes</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// loop through all nodes selected
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>currentNode</span> <span class=o>=</span> <span class=nx>selection</span><span class=p>.</span><span class=nx>selectedNode</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span> <span class=c1>// the current selected node in the loop
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posX</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordX</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the X position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kd>var</span> <span class=nx>posY</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>coordY</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>);</span> <span class=c1>// get the Y position on the node graph
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>newNode</span> <span class=o>=</span>  <span class=nx>node</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>(</span><span class=nx>currentNode</span><span class=p>),</span> <span class=s2>&#34;drawing_&#34;</span> <span class=o>+</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=nx>posX</span> <span class=o>+</span> <span class=p>(</span><span class=mi>120</span> <span class=o>*</span> <span class=nx>i</span><span class=p>),</span> <span class=nx>posY</span> <span class=o>+</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=nx>node</span><span class=p>.</span><span class=nx>link</span><span class=p>(</span><span class=nx>newNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>currentNode</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>scene</span><span class=p>.</span><span class=nx>endUndoRedoAccum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=c1>// if more than one node is selected run the following
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>MessageBox</span><span class=p>.</span><span class=nx>information</span><span class=p>(</span><span class=s2>&#34;You must select only ONE composite node!&#34;</span><span class=p>);</span> <span class=c1>// displays warning message
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Now remember to save the script. and test and execute it.</p><p>Challenge:</p><p>Try and add more conditional logic.</p><hr><a href=#examples><h1 id=examples><span class=hanchor arialabel=Anchor># </span>Examples</h1></a><p>Automating the creation of a camera move:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Define the start and end position of the camera
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>startPosition</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>100</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>endPosition</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define the duration of the camera move
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>duration</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create a camera move from the start to end position over the defined duration
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>camera</span> <span class=o>=</span> <span class=nx>Camera</span><span class=p>.</span><span class=nx>create</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>camera</span><span class=p>.</span><span class=nx>setPosition</span><span class=p>(</span><span class=nx>startPosition</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>animation</span> <span class=o>=</span> <span class=nx>Animation</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>camera</span><span class=p>,</span> <span class=nx>duration</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>animation</span><span class=p>.</span><span class=nx>addKeyFrame</span><span class=p>(</span><span class=nx>endPosition</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Changing color of an element:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Define the color you want to use
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>newColor</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Get the elements in the scene
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>elements</span> <span class=o>=</span> <span class=nx>Scene</span><span class=p>.</span><span class=nx>getElements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Loop through each element
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>elements</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Get the current element
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>var</span> <span class=nx>element</span> <span class=o>=</span> <span class=nx>elements</span><span class=p>[</span><span class=nx>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Change the color of the element
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>element</span><span class=p>.</span><span class=nx>setColor</span><span class=p>(</span><span class=nx>newColor</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Exporting an animation to a movie file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Define the file path and format of the movie file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>filePath</span> <span class=o>=</span> <span class=s2>&#34;/path/to/movie.mov&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>format</span> <span class=o>=</span> <span class=s2>&#34;quicktime&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Get the current scene
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>scene</span> <span class=o>=</span> <span class=nx>Scene</span><span class=p>.</span><span class=nx>getCurrentScene</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Export the scene as a movie file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>movie</span> <span class=o>=</span> <span class=nx>scene</span><span class=p>.</span><span class=nx>exportAsMovie</span><span class=p>(</span><span class=nx>filePath</span><span class=p>,</span> <span class=nx>format</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><hr><a href=#possible-tools><h1 id=possible-tools><span class=hanchor arialabel=Anchor># </span>Possible Tools</h1></a><p>are we able to make it so that when the drawing layers are created they&rsquo;re connected to the composite immediately?</p><p>custom toolbar?</p><p>select 2 drawing.isolate nodes
create cutter/inverted cutter
plug nodes into cutter
name cutter:
what is being cut/revealed by what is previously selected</p><p>add parent to selection -> add child to selection</p><p>I&rsquo;m trying to think of ways to simplify aligning nodes like being able to select all the drawing nodes without having to draw a big long selection box over all of them to align them or something but idk how practical it&rsquo;d be with pegs and stuff so maybe not</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/notes/courses/scripting-for-animation-2-course-timeline/ data-ctx="notes/courses/Javascript for Toonboom" data-src=/notes/courses/scripting-for-animation-2-course-timeline class=internal-link>Scripting for animation 2 course timeline</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://notes.benshurts.com/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Ben Shurts using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://notes.benshurts.com/>Home</a></li><li><a href=https://twitter.com/artofbenshurts>Twitter</a></li><li><a href=https://github.com/benshurts>Github</a></li></ul></footer></div></div></body></html>